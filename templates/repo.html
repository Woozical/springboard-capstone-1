{% extends 'base.html' %}

{% block title %}
Untitled Repo
{% endblock %}

{% block content %}
<!-- To Do: WTForms for forms? -->
<!-- To Do: Noscript version -->
<div class="container">
<div class="row">
    <div id="flashes">
    </div>
</div>
<div class="row">
    <div class="col-8" id="content">
        <h1 id="repo-title"></h1>
        <p id="repo-desc"></p>
        <div id="repo-entries">
        </div>
    </div>
    <div class="col-4" id="controls">
        {% if session['working_repo'] == repo.access_key %}
        <button class="btn btn-success" id="btn-save-changes">Save Changes</button>
        <form id="new-link-form" action="">
            <input type="text" id="input-url" name="new" placeholder="Paste link here">
            <button class="btn btn-primary btn-sm">Enter</button>
        </form>
        <button class="btn btn-outline-primary" id="btn-new-divide">Add Divider</button>
        <button class="btn btn-outline-primary" id="btn-new-tbox">Add TextBox</button>
        <hr>
        <button class="btn btn-outline-info" id="btn-edit-repo">
            <i class="bi bi-gear"></i>Edit Repo Info
        </button>
        <button class="btn btn-outline-danger" id="btn-delete-repo">Delete Repo</button>
        {% else %}
        <button id="btn-auth-repo">Edit</button>
        {% endif %}
    </div>
</div>

{% if session['working_repo'] == repo.access_key %}
<!-- To Do: Make forms modals -->
<!-- Move <form>s into templates/forms and include -->
<div class="modal" role="dialog" id="repo-delete-div">
    <form class="modal-form" id="repo-delete-form">
            <div class="alert text-center alert-warning">
                Are you sure you want to delete this repository?
                This action is not reversable.
            </div>
            <div class="form-group row justify-content-center text-center">
                <label class="form-label" for="repo-delete-pw">Enter password to confirm:</label>
                <input class="form-control w-50" type="password" id="repo-delete-pw" name="pass_phrase">
                <small class="text-danger" id="repo-delete-response"></small>
            </div>
            <br>
            <div class="row justify-content-center">
                <div class="col-2">
                    <button class="btn btn-outline-secondary btn-lg" type="button" id="btn-close-repo-delete">Cancel</button>
                </div>
                <div class="col-2">
                    <button class="btn btn-danger btn-lg" type="submit">Confirm</button>
                </div>
            </div>
    </form>
</div>
<div class="modal" role="form" id="repo-edit-div">
    <form class="modal-form" id="repo-edit-form">
        <div class="container-fluid">
        <div class="row">
            <div class="col">
                <h5>Edit Repository Info</h5>
            </div>
            <div class="col">
                <span class="close"><i id="close-repo-modal" class="bi bi-x-lg"></i></span>
            </div>
        </div>
        <hr>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label" for="repo-title-input">Title</label>
            <div class="col-sm-10">
                <input class="form-control" type="text" id="repo-title-input" name="repoTitle">
            </div>
        </div>
        <br>
        <div class="form-group row">
            <label class="col-sm-2 col-form-label" for="repo-desc-input">Description</label>
            <div class="col-sm-10">
                <input class="form-control" type="text" id="repo-desc-input" name="repoDesc">
            </div>
        </div>
        <br>
        <div class="form-group row">
            <div class="col-sm-2">Private Repo</div>
            <div class="col-sm-8">
                <input class="form-check-input" type="checkbox" id="repo-privacy-input" name="repoPrivacy">
                <label class="form-check-label" for="repo-privacy-input">Yes/No</label>
            </div>
        </div>
        <br>
        <button type="submit" class="btn btn-success btn-lg">Save</button> 
        </div>
    </form>
</div>
{% endif %}

{% if session['working_repo'] == repo.access_key %}
<div class="modal" id="entry-edit-div">
    <form class="modal-form" id="entry-edit-form">
        <div class="container-fluid">
            <div class="row">
                <div class="col">
                    <h5>Edit Entry</h5>
                </div>
                <div class="col">
                    <span class="close"><i id="close-entry-modal" class="bi bi-x-lg"></i></span>
                </div>
            </div>
            <hr>
            <div class="form-group row">
                <label class="col-sm-1 col-form-label" for="entry-title-input">Title</label>
                <div class="col-sm-5">
                    <input class="form-control" type="text" id="entry-title-input" name="entryTitle">
                </div>
                <label class="col-sm-1 col-form-label" for="entry-url-input">URL</label>
                <div class="col-sm-5">
                    <input class="form-control" type="url" id="entry-url-input" name="entryURL">
                </div>
            </div>
            <br>
            <div class="form-group row">
                <label class="col-sm-1 col-form-label" for="entry-image-input">Image</label>
                <div class="col-sm-8">
                    <input class="form-control" type="url" id="entry-image-input" name="entryImage">
                </div>
                <label class="col-sm-1 col-form-label" for="entry-type-input">Type</label>
                <div class="col-sm-auto">
                    <select class="form-control" id="entry-type-input" name="entryType">
                        <option value="link">Link</option>
                        <option value="divider">Divider</option>
                        <option value="text_box">Text Box</option>
                    </select>
                </div>
            </div>
            <br>
            <div class="form-group form-row">
                <label class="form-label" for="entry-desc-input">Description</label>
                    <textarea class="form-control" rows="3" type="text" id="entry-desc-input" name="entryDesc"></textarea>

            </div>
            <br>
            <button type="button" id="btn-entry-delete" class="btn btn-lg btn-outline-danger">Remove</button>
            <button type="submit" class="btn btn-lg btn-success">Done</button>
        </div>
    </form>
</div>
{% endif %}
</div>

{% endblock %}

{% block script %}
<script src="/static/app.js"></script>
{% if session.get('working_repo') == repo.access_key %} 
    <script>
        const viewState = 1;
        loadRepoData('{{repo.access_key}}');
    </script>
{% else %}
    <script>
        const viewState = 0;
        loadRepoData('{{repo.access_key}}');
    </script>
{% endif %}
{% endblock %}