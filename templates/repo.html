{% extends 'base.html' %}

{% block title %}
Untitled Repo
{% endblock %}

{% block content %}
<!-- To Do: WTForms for forms? -->
<!-- To Do: Noscript version -->
<div class="container">
    <div class="row">
        <div class="col-8" id="content">
            <h1 id="repo-title">{{repo.title}}</h1>
            <p id="repo-desc">{{repo.description}}</p>
            <div id="repo-entries">
                <noscript>
                    <div class="alert alert-warning">Javascript is required to use this website.</div>
                </noscript>
            </div>
        </div>
        <div class="col-4 text-center">
            <div id="controls">
            {% if session['working_repo'] == repo.access_key %}
                <h4 class="text-white">Controls</h3>
                <small id="help-btn" class="text-muted tip">(Help)</small>
                <form id="new-link-form" action="">
                    <textarea name="new" id="input-url" cols="50" rows="2" placeholder="Paste links here..."></textarea>
                </form>
                
                <button title="Add Links" form="new-link-form" class="btn btn-wide btn-lg btn-primary">
                    <i class="bi bi-link"></i>
                </button>
                <hr>
                <button title="Create Text Box" class="btn btn-lg btn-primary" id="btn-new-tbox"><i class="bi bi-blockquote-right"></i></button>
                <button title="Create Divider" class="btn btn-lg btn-primary" id="btn-new-divide"><i class="bi bi-hr"></i></button>
                <hr>
                <button title="Save Changes" class="btn btn-outline-success" id="btn-save-changes"><i class="bi bi-save2"></i></button>
                <button title="Edit Repository Information" class="btn btn-outline-info" id="btn-edit-repo">
                    <i class="bi bi-gear"></i>
                </button>
                <button title="Delete Repository" class="btn btn-outline-danger" id="btn-delete-repo"><i class="bi bi-trash"></i></button>
                {% else %}
                <button id="btn-auth-repo">Edit</button>
                {% endif %}
                <hr>
                <div class="text-center alert" id="flashes"></div>
                <br>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div class="modal" role="status" id="loading">
        <div class="text-center">
            <div class="text-white spinner-border spin-center" style="width: 5rem; height: 5rem;">
              <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>
    <div class="modal" id="help-modal">
        {% include 'docs/help.html' %}
    </div>
    {% if session['working_repo'] == repo.access_key %}
    <div class="modal" role="dialog" id="repo-delete-div">
        {% include 'forms/repo-delete.html' %}
    </div>
    <div class="modal" role="form" id="repo-edit-div">
        {% include 'forms/repo-edit.html' %}
    </div>
    <div class="modal" id="entry-edit-div">
        {% include 'forms/entry-edit.html' %}
    </div>
    {% endif %}
    <!--  -->
</div>

{% endblock %}

{% block script %}
<script src="/static/app.js"></script>
{% if session.get('working_repo') == repo.access_key %} 
    <script>
        const viewState = 1;
        loadRepoData('{{repo.access_key}}');
    </script>
{% else %}
    <script>
        const viewState = 0;
        loadRepoData('{{repo.access_key}}');
    </script>
{% endif %}
{% endblock %}